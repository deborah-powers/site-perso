<!DOCTYPE html><html><head>
	<title>mes dépenses</title>
	<meta name='viewport' content='width=device-width,initial-scale=1'/>
	<meta charset='utf-8'/>
	<base target='_self'>
	<link rel='icon' type='image/png' href='static/nounours.svg'/>
	<link rel='stylesheet' type='text/css' href='static/structure.css'/>
	<link rel='stylesheet' type='text/css' href='static/perso.css'/>
	<script type='text/javascript' src='static/database.js'></script>
	<script type='text/javascript' src='static/library.js'></script>
	<script type='text/javascript' src='static/dynaPlay.js'></script>
<style type='text/css'></style></head><body>
	<h1>une dépense</h1>
	<p>le (( date )) à (( lieu )).</p>
	<p>(( montant )) euros de (( categorie ))</p>
	<p>(( commentaire ))</p>
	<nav>
		<a href='/site-dp/pwa/depense/?id=(( id ))'>modifier</a>
		<button onclick='delFromIdb((( id )))'>supprimer</button>
		<a href='/site-dp/pwa/depense/liste.html?type=day'>les dépenses du jour</a>
		<a href='/site-dp/pwa/depense/liste.html?type=week'>les dépenses de la semaine</a>
		<a href='/site-dp/pwa/depense/liste.html?type=all'>toutes les dépenses</a>
	</nav>
<script type='text/javascript'>
	const params = itemFromUrl();
	var id = parseInt (params.id);

	var date ="";
	var lieu ="";
	var categorie ="";
	var montant ="";
	var commentaire ="";

function getItem (id){
	const requestDb = window.indexedDB.open (idbBase, 3);
	requestDb.onerror = function (event){
		console.log ('impossible de vous connecter à indexedDB');
		dpInit();
	}
	requestDb.onsuccess = function (event){
		const store = event.target.result.transaction ([idbStore], 'readonly').objectStore (idbStore);
		const request = store.get (id);
		request.onerror = function(){
			console.log ("la récupération de l'objet a échoué", id);
			dpInit();
		};
		request.onsuccess = function (event){
			date = event.target.result.date;
			lieu = event.target.result.lieu;
			categorie = event.target.result.categorie;
			montant = event.target.result.montant;
			commentaire = event.target.result.commentaire;
			dpInit();
};}}
getItem (id);

function getItemBis (id, callback){
	const requestDb = window.indexedDB.open (idbBase, 3);
	requestDb.onerror = function (event){
		console.log ('impossible de vous connecter à indexedDB');
		dpInit();
	}
	requestDb.onsuccess = function (event){
		const store = event.target.result.transaction ([idbStore], 'readonly').objectStore (idbStore);
		const request = store.get (id);
		request.onerror = function(){
			console.log ("la récupération de l'objet a échoué", id);
			dpInit();
		};
		request.onsuccess = function (event){
			date = event.target.result.date;
			lieu = event.target.result.lieu;
			categorie = event.target.result.categorie;
			montant = event.target.result.montant;
			commentaire = event.target.result.commentaire;
			dpInit();
};}}
</script>
</body></html>