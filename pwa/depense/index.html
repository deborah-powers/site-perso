<!doctype html><html><head>
	<title>mes dépenses</title>
	<meta name='viewport' content='width=device-width,initial-scale=1'/>
	<meta charset='utf-8'/>
	<base target='_blank'>
	<link rel='manifest' href='manifest.webmanifest'/>
	<link rel='icon' type='image/png' href='static/icone-192.png'/>
	<meta name='msapplication-TileImage' content='static/icone-192.png'>
	<meta name='msapplication-TileColor' content='#C36'>
	<meta name='theme-color' content='#C36'/>
	<link rel='apple-touch-icon' type='image/png' href='static/icone-192.png'/>
	<meta name='apple-mobile-web-app-capable' content='yes'>
	<meta name='apple-mobile-web-app-status-bar-style' content='#C36'>
	<meta name='apple-mobile-web-app-title' content='mes dépenses'>
	<link rel='stylesheet' type='text/css' href='static/structure.css'/>
	<link rel='stylesheet' type='text/css' href='static/perso.css'/>
	<script type='text/javascript' src='static/database.js'></script>
	<script type='text/javascript' src='../../library-js/config.js'></script>
</head><body>
	<h1>enregistrer mes dépenses</h1>
	<form>
		<label for='champ-date'>date</label><input type='date' id='champ-date'/>
		<input type='button' onclick='sauverDepense()' value='valider'/>
	</form>
	<button onclick='sauverModif()'>enregistrer vos modifs</button>
	<button id='install-pwa'>installer l'application</button>
	<section></section>
	<script type='text/javascript' src='service-launcher.js'></script>
	<script type='text/javascript'>

Date.prototype.toStringPerso = function(){
	const year = this.getFullYear();
	const month =1+ this.getMonth();
	const day = this.getDate();
	var dateStr = year +'-';
	if (month <10) dateStr = dateStr +'0';
	dateStr = dateStr + month +'-';
	if (day <10) dateStr = dateStr +'0';
	dateStr = dateStr + day;
	return dateStr;
}
const databaseName = 'depense';
var msgList =[
	{ message: 'message b' },
	{ message: 'message c' },
	{ message: 'message a' },
	{ message: 'message d' }
]
var depenseList = document.getElementsByTagName ('section')[0];
var depenseDate = document.getElementById ('champ-date');
depenseDate.value = new Date().toStringPerso();

function printMessages (messageList){
	msgList =[];
	depenseList.innerHTML ="";
	for (var m=0; m< messageList.length; m++){
		msgList.push (messageList[m]);
		depenseList.innerHTML = depenseList.innerHTML +'<p>'+ messageList[m].message +'</p>';
	}
}
getFromIdb (databaseName, printMessages);
function sauverDepense(){
	var date = depenseDate.value;
	console.dir (date);
	msgList.push ({ date: date });
	printMessages (msgList);
}
function sauverModif(){
	sendToIdb (databaseName, msgList,
		function(){ sendToOdb (databaseName, msgList); });
}
	</script>
</body></html>